{{Infobox device
| manufacturer = Next Thing Co.
| name = CHIP
| codename = ntc-chip
| image = File:Ntc_chip_front.png
| imagecaption = Next Thing Co. CHIP
| releaseyear = 2015
| originalsoftware = Debian on Linux 4.4
| chipset = Allwinner R8
| cpu = 1x 1.0 GHz Cortex-A8
| gpu = Mali-400 MP1
| storage = 8GB MLC NAND
| display = Composite video
| memory = 512 MB DDR3
| architecture = armv7
<!-- the following status_* questions should be answered with Y - yes, P - partial, N - no, or left blank (for untested or unknown) -->
| status_usbnet = <!-- USB networking does work? then put Y here and delete this comment -->
| status_flashing = <!-- Flashing with "pmbootstrap flasher" works? Put Y here. It works the same for everything coming below. -->
| status_touch = -
| status_screen = <!-- The display is working? -->
| status_wifi = <!-- Wireless network works? -->
| status_xwayland = <!-- Showing X11 applications in a Wayland compositor (Weston, KWin, ...) works? -->
| status_fde = <!-- When installing with full disk encryption, can you type in the password with the on screen keyboard? -->
| status_mainline = <!-- Instead of a Linux kernel fork, it is possible to run mainline. -->
| status_battery = <!-- Charging the battery with charging-sdl is possible -->
| status_3d = <!-- Hardware accelerated 3D graphics (e.g. with freedreno) -->
| status_accel = <!-- The sensor that measures proper acceleration works -->
| status_audio = <!-- Using the device's speakers/headphone jack works -->
| status_bluetooth = <!-- It's possible to pair and use other devices via the bluetooth protocol -->
| status_camera = -
| status_gps = -
| status_mobiledata = -
| status_sms = -
| status_calls = -
| status = <!-- Text displayed in the "not booting" table on the Devices page , e.g "kernel compiles, doesn't boot" -->
| booting = yes <!-- The device is booting at all, can be yes/no *IMPORTANT* -->

<!-- you can also use these lines if you need to:
if the device haven't originally ran Android OS, e.g. Nokia N900
| n-android =  âœ”
Version of the kernel that pmos is running
| pmoskernel = 4.4.66
see Unixbench page on wiki
| whet_dhry = 0.0
Is OTG available, not used in wiki
| status_otg = -
-->
}}

== Contributors ==
* Symmetrist

== Maintainer(s) ==
<!-- Only if this device doesn't run on linux-postmarketos yet! -->
<!-- This person needs to be willing to answer questions from users of this device -->
* Symmetrist

== Users owning this device ==
{{Device owners}}
<!-- autogenerated, use {{Owns device|devicepage|notes}} on your profile page -->
<!-- use _ instead of spaces in device page name, e.g. {{Owns device|HTC_Desire_(htc-bravo)|custom notes}}-->
<!-- you may need to purge page cache to see changes (more->purge cache)-->
<!-- you can use {{My devices}} on your profile page to show table with all your devices -->

== How to enter flash mode ==
The CHIP has two different flashing modes:
* FEL mode: used to flash bootloader and rootfs
* Fastboot mode: used to flash rootfs


To enter '''FEL''' mode:
* Connect the FEL and GND pins with a jumper cable
* Power on the CHIP

To enter '''Fastboot''' mode:
* Connect an serial (UART) USB adapter to UART1-TX, UART1-RX and GND
* Power on the CHIP
* Press enter during boot up to access the U-Boot console
* On the console type `fastboot 0`

== Configure U-Boot ==
PostmarketOS loads an initramfs together with the kernel, while original Debian installation only used the kernel.

To boot PostmarketOS we need to change the U-Boot configuration to support the initramfs.

From the U-boot serial console issue the following commands:
* Print the current value of the `bootcmd`, save it in case you want to restore it later.
<syntaxhighlight lang="shell-session">
> printenv bootcmd
</syntaxhighlight>
* Change the `bootcmd` value
<syntaxhighlight lang="shell-session">
> printenv bootcmd
> setenv bootcmd "gpio set PB2; ${bootcmd_fel}; ${boot_initrd};"
> saveenv
</syntaxhighlight>

== Create the UBIfs image ==
<!-- add more sections below as necessary, e.g. WiFi, photos, ... -->
* Configure the installation and build the system
<syntaxhighlight lang="shell-session">
$ pmbootstrap init
$ pmbootstrap install
</syntaxhighlight>

In `workdir/chroot_rootfs_ntc-chip` there is the rootfs for your ntc-chip

The following commands needs to be launched from your pmbootstrap workdir
* Copy dtb from linux-ntc-chip
<syntaxhighlight lang="shell-session">
$ sudo cp cache_git/pmaports/device/testing/linux-ntc-chip/sun5i-r8-chip.dtb chroot_rootfs_ntc-chip/boot/
</syntaxhighlight>

Install mtd-utils from your distro repositories e.g. `pacman -S mtd-utils`
* Create the UBIfs image
<syntaxhighlight lang="shell-session">
$ mkdir ubi
$ sudo mkfs.ubifs -m 16384 -e 0x1f8000 -c 2000 -r chroot_rootfs_ntc-chip ubi/ubifs.img
$ sudo chown youruser:youruser ubi/ubifs.img
$ ubinize -o ubi/ubi.img -m 16384 -p 2MiB -s 16384 cache_git/pmaports/device/testing/device-ntc-chip/ubinize.cfg
$ img2simg ubi/ubi.img ubi/ubi.img.sparse 2097152
</syntaxhighlight>

== Flash the UBIfs image ==
* Enter fastboot mode as described above
* On your computer
<syntaxhighlight lang="shell-session">
$ fastboot erase UBI
$ fastboot flash UBI ubi/ubi.img.sparse
$ fastboot reboot
</syntaxhighlight>

== See also ==
<!--
Link to related GitLab issues or merge requests like the following (replace CHANGEME with the ID, e.g. 1234):
* {{MR|CHANGEME|pmaports}} Initial merge request
* {{issue|CHANGEME|pmaports}} Some related issue
You can also add normal web links:
* [https://redmine.replicant.us/projects/replicant/wiki/GalaxyS2I9100 Replicant wiki page]
-->
* {{MR|1098|pmaports}} Initial merge request
* [https://linux-sunxi.org/NextThingCo_CHIP Sunxi wiki page]
* [https://en.wikipedia.org/wiki/CHIP_(computer) Wikipedia wiki page]
* [https://github.com/Thore-Krug/Flash-CHIP Tool for flashing the CHIP]
* [https://byteporter.com/ntc-chip-micro-sd-slot/ CHIP microSD slot mod]
* [https://github.com/umiddelb/armhf/wiki/Get-more-out-of-%22Das-U-Boot%22 Good U-Boot guide]
<!--
If you manage to get your device packages merged, uncomment links below and change DEVICE_CODENAME with the actual one.
* [https://gitlab.com/postmarketOS/pmaports/tree/master/device/device-DEVICE_CODENAME Device package]
* [https://gitlab.com/postmarketOS/pmaports/tree/master/device/linux-DEVICE_CODENAME Kernel package]
-->
