== Framebuffer ==

On most Android devices, a somewhat working framebuffer is required to get Weston and other Wayland compositors running. The alternative to framebuffer would be [[Glossary#dri|DRI]].

If your framebuffer does not work out of the box, try the following:

* Boot TWRP/Android and read out the correct framebuffer configurations from the /sys... paths and try to set them in pmOS
* If you made it work, create an initfs hook, that instantly sets the framebuffer right. [https://github.com/postmarketOS/pmbootstrap/blob/ad17254e86b7dab4f87e139eaeb298222f37a031/aports/device/device-lg-mako/initfs-hook.sh Example]

If the screen looks laggy, it might be a known issue with refresh rate. It can be solved by hardcoding the refresh rate in the video driver, see [https://github.com/postmarketOS/pmbootstrap/blob/ad17254e86b7dab4f87e139eaeb298222f37a031/aports/device/linux-sony-amami/mdss_fb_refresh_rate.patch mdss_fb_refresh_rate.patch].

== Touch screen ==

=== libinput ===
This library is used by almost everything accessing your touch screen (e.g. Weston, X11, kwin). Just follow [[Osk-sdl#Set_touchscreen_device|these instructions]] to set your <code>deviceinfo_dev_touchscreen</code> variable in the [[deviceinfo]] file.

Modern [[Device specific package|device specific packages]] will generate the udev-rule automatically then, and as nice side-effect it will also work in <code>osk-sdl</code>.

(If your device package does not generate the udev rule, please adjust the <code>build()</code> and <code>install()</code> functons as described [[Device specific package|here]].)

==== Calibration (needed for resistive touch screens) ====
Please test first if your device works without any special calibration - in most cases you don't need it!

* Install postmarketOS with Weston on your phone
* Connect to your phone via SSH
* Run <code>weston-calibrator</code>
* Adjust your <code>deviceinfo_dev_touchscreen_calibration</code> to the output from <code>weston-calibrator</code> ([https://github.com/postmarketOS/pmbootstrap/pull/1034/files#diff-21ee1b263b9df2c4b69bb4b6796dab37 example]).

==== Adjust the generated values ====
If the generated values don't work for you, try to adjust them manually. Relevant quote from the chat (feel free to make this more wiki friendly):
<blockquote>
michitux: Is there any documentation what those 6 calibration values mean? So far I only found a documentation on a 3x3 matrix. I have a working touch screen, but the calibration values generated by weston-calibrator seem to not to work. I get the impression that there is something wrong with rotation.

MartijnBraam: michitux: https://github.com/postmarketOS/pmbootstrap/issues/182 is all the docs on what the values mean 

michitux: Okay, that helped, thank you, I have a working calibration now. Somehow the values generated by weston-calibrator are strange. They make sense given the aspect ratio of the screen but somehow you don't need to multiply with the aspect ratio when mapping x to y and vice-versa. So weston-calibrator would give me "0 1.6 0 -0.625 0 800" (if I hit the crosses perfectly) but what works is "0 1 0 -1 0 800". 
</blockquote>

== Legacy ==
=== libinput: old method ===
{{syslog|weston}}
Here is how to do it without <code>devicepkg-dev</code> (not recommended, for reference only).

* Make sure, that Weston runs on the device
* Look in the logs (via SSH) for the touch device name. For <code>lg-mako</code>, the name is <code>touch_dev</code>, but it may be different for your device.
* Copy [https://github.com/postmarketOS/pmbootstrap/blob/master/aports/device/device-lg-mako/90-android-touch-dev.rules 90-android-touch-dev.rules] from <code>device-lg-mako</code> to your device's aport. Replace <code>touch_dev</code> with your touch device name. Adjust the <code>APKBUILD</code>, so it gets installed properly ([https://github.com/postmarketOS/pmbootstrap/blob/master/aports/device/device-lg-mako/APKBUILD Example])

<pre>
SUBSYSTEM==&quot;input&quot;, ATTRS{name}==&quot;touch_dev&quot;, \
ENV{ID_INPUT}=&quot;1&quot;, ENV{ID_INPUT_TOUCHSCREEN}=&quot;1&quot;
</pre>
Reload udev rules:

<source lang="bash"># Reload all rules
udevadm control --reload
# Re-apply those rules on all devices
udevadm trigger</source>
