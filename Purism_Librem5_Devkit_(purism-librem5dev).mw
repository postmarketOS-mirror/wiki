{{Infobox device
| manufacturer = Purism
| name =  Librem 5 Devkit
| codename = purism-librem5dev
| image = File:purism-librem5dev.jpg
| imagecaption = 
| releaseyear = 2018
| originalsoftware = PureOS
| chipset = Emcraft NXP i.MX8M
| cpu = NXP i.MX8M
| gpu = Vivante GC7000Lite
| storage = 32 GB EMMC
| display = 1440x720
| memory = 3 GB
| architecture = aarch64
<!-- the following status_* questions should be answered with Y - yes, P - partial, N - no, or left blank (for untested or unknown) -->
| status_usbnet = <!-- USB networking does work? then put Y here and delete this comment -->
| status_flashing = <!-- Flashing with "pmbootstrap flasher" works? Put Y here. It works the same for everything coming below. -->
| status_touch = Y
| status_screen = Y
| status_wifi = P
| status_xwayland = P
| status_fde = <!-- When installing with full disk encryption, can you type in the password with the on screen keyboard? -->
| status_mainline = <!-- Instead of a Linux kernel fork, it is possible to run mainline. -->
| status_battery = <!-- Charging the battery with charging-sdl is possible -->
| status_3d = P
| status_accel = <!-- The sensor that measures proper acceleration works -->
| status_audio = P
| status_bluetooth = P
| status_camera = <!-- Taking photos and videos works. -->
| status_gps = Y
| status_mobiledata = <!-- Connecting to the Internet via cellular network. -->
| status_sms = <!-- Sending and receiving short messages works as intended. -->
| status_calls = <!-- Talking to other people over the cellular network. -->
| status_otg = P
| booting = Y
}}

== Contributors ==
* ''[https://gitlab.com/craftyguy craftyguy]''
* ''[https://gitlab.com/bshah bshah]''

== How to enter flash mode ==

The devkit has a switch on the same side as the reboot button, wifi switch, camera switch, and modem switch. Move it to the "USB Mode" position and hit the reboot button next to it in order to put the device into 'flash' mode.

== Installation ==

=== Flashing ===

pmbootstrap now has support for flashing the devkit with the <code>flasher</code> command. After running <code>pmbootstrap install</code> to generate a rootfs, the devkit can be flashed by putting it into 'USB mode' and executing <code>pmbootstrap flasher flash_rootfs</code>

Once the image has been flashed, place the device into emmc mode and hit the reboot button to start booting postmarketOS. The first boot can take a few minutes as it resizes the rootfs to fill all available space on the emmc disk.

=== Graphics ===

The Vivante GPU in the devkit is not fully currently supported upstream in Mesa. In order to achieve preliminary 3D acceleration on this device, you can use the [https://gitlab.com/craftyguy/pmaports/commits/librem5_playground 'librem5_playground' branch in craftyguy's repo]. This builds a Purism branch of Mesa with not-yet-upstream patches.

The <code>device-librem5-devkit</code> package does not include this newer Mesa as a dependency.

If you select a GUI during <code>pmbootstrap init</code> and have this pmaports branch checked out under the aports directory, then the main Mesa packages (excluding mesa-dri-*) will automatically built into the rootfs image. The following mesa-dri-* packages will need to be copied to device manually and installed. To copy the Mesa packages built by this branch (ignoring mesa-dev and swrast/osmesa) to the device:

 <nowiki>
$ scp /home/YOU/.local/var/pmbootstrap-out/packages/aarch64/mesa-19.0.0-r999.apk \
    /home/YOU/.local/var/pmbootstrap-out/packages/aarch64/mesa-dri-etnaviv-19.0.0-r999.apk \
    /home/YOU/.local/var/pmbootstrap-out/packages/aarch64/mesa-dri-imx-19.0.0-r999.apk \
    /home/YOU/.local/var/pmbootstrap-out/packages/aarch64/mesa-egl-19.0.0-r999.apk \
    /home/YOU/.local/var/pmbootstrap-out/packages/aarch64/mesa-gl-19.0.0-r999.apk \
    /home/YOU/.local/var/pmbootstrap-out/packages/aarch64/mesa-glapi-19.0.0-r999.apk \
    /home/YOU/.local/var/pmbootstrap-out/packages/aarch64/mesa-gles-19.0.0-r999.apk \
    user@<IP OF DEVKIT>:~/
</nowiki>

These can be easily installed/upgraded by running the following when logged into the device:

 <nowiki>
$ sudo apk add mesa*.apk
</nowiki>

Note: The Mesa package in this branch disables all other GPU drivers to help reduce compile time, and may also be buggy since it's based off of the Mesa master branch, so it's not likely to be merged into mainline pmaports.

== Todo ==

* Bring up cellular modem
* Resolve issues with Wifi
** Interface shows up in OS, and wpa_supplicant seems to connect(?), but no IP.
* Resolve issues with Bluetooth
** Bluetooth can be started by loading the rsi_91x module with <code>dev_oper_mode=14</code> but this disables Wifi station/client mode and enables Wifi AP mode. It doesn't seem to work with <code>dev_oper_mode=13</code>, which enables Wifi client mode. 
* Current dts enables usb host but doesn't enable LCD display
* Test/enable camera
* Test/enable ambient light sensor

== See also ==

* [https://developer.puri.sm/Librem5/ Purism Librem5 devkit documentation]
* {{MR|250|pmaports}} MR that should enable modem support (untested, and now the ofono version is outdated; but maybe this is useful for future reference)
