{{Infobox device
| manufacturer = Samsung
| name =  Galaxy Tab 10.1
| codename = p4wifi
| image = File:P4wifi infobox.png
| imagecaption = Xcfe4 running on Samsung Galaxy Tab 10.1 (p4wifi)
| releaseyear = 2011
| originalsoftware = Android 3.1 Honeycomb
| chipset = Nvidia Tegra 2
| cpu = 1Ghz ARM Cortex-A9
| gpu = Tegra 2
| storage = 16/32 GB
| display = 1280Ã—800
| memory = 1GB
}}

== Contributors ==
* decatf

== Maintainer(s) ==
* decatf

== Introduction ==

postmarketOS for the Samsung Galaxy Tab 10.1 runs on mainline Linux kernel fork. The kernel uses both mainline and forward ported drivers. Some peripherals are using mainline device driver where applicable. Some peripherals which are not working on or don't have mainline drivers are using drivers forward ported from the stock 3.1.10 kernel.

== What works ==
* Flashing with heimdall
* USB SSH access
* Touch
* DRM fbdev / 2D acceleration (Grate driver)
* VDPAU h264 hardware decoding
* Wifi
* Battery
* Audio (headphone & speaker only)
* Bluetooth

== What does not work ==
* 3D acceleration
* Camera
* GPS
* Accelerometers

== How to enter flash mode ==
Press and hold Power + Volume Down buttons

== Installation ==

# Init pmbootstrap<source lang="shell">$ ./pmbootstrap.py init</source> Choose 'samsung-p4wifi' as target device.
# Start the build process<source lang="shell">$ ./pmbootstrap.py build linux-samsung-p4wifi
$ ./pmbootstrap.py build device-samsung-p4wifi
$ ./pmbootstrap.py install --no-fde</source>
# Enter flash (download) mode
# Flash the kernel and system images<source lang="shell">$./pmbootstrap.py flasher flash_kernel
$./pmbootstrap.py flasher flash_rootfs</source>

== Battery ==
The battery in this device is the <code>max17042</code>. The downstream kernel provides an early implementation of a driver for the <code>max17042</code> battery. The implementation of the battery and charger driver are split across <code>p4_battery.c</code> and <code>max17042_battery.c</code> in the downstream kernel. The name of the charger hardware in this tablet is an unknown.

The downstream drivers have references to <code>max8903</code> which is a charger used in other Samsung devices. The <code>max8903</code> has similar hardware characteristics as the charger in this tablet. The two are definitely not the same but there is a <code>max8903</code> driver in mainline which a useful reference.

The mainline max17042 battery driver works but the downstream driver provided a much more complex implementation of the battery/charger drivers. There is no driver for the charging circuit so much important functionality is not present in the mainline kernel. The downstream charger driver implements logic to handle charge full and low battery which affect the health of the battery. For these reasons it is safer for regular use to keep using drivers forward ported from the downstream kernel.

== Graphics ==
The reverse engineer grate-driver provides 2D acceleration on X11. 3D acceleration is not working. This means that Xfce4 and Mate desktop will work. Hildon requires an OpenGL backend. Wayland UIs will only work with the framebuffer driver.

grate-drver packaging can be found at [http://github.com/Decatf/pmbootstrap/tree/feature/mesa-grate github.com/Decatf/pmbootstrap/tree/feature/mesa-grate]

=== Video Decoding ===

Video Decoder Engine (VDE) was added to mainline kernel v4.16. The grate-driver includes hardware h264 decoding with libvdpau-tegra.

== Audio ==

Headphone and speaker output are working on the mainline wm8994 driver. Microphone inputs are not working.

The ALSA UCM config files were generated using the <code>xml2ucm</code> tool. The <code>mixer_paths.xml</code> and <code>p4wifi.config.xml</code> can be found in this [https://gist.github.com/Decatf/c37dda86a96f953f8b77eb9502d6681b github gist].
<source lang="shell">$ stack exec -- xml2ucm -m mixer_paths.xml -c p4wifi-config.xml -o examples</source>

== Wifi ==


== Cellular Modem ==
The xmm6260 modem was used in quite a few Samsung Android devices from the same era as this tablet. The Samsung Galaxy Tab 10.1 3G (p4) and Samsung Galaxy Tab 10.1 from T-Mobile (p4tmo) are otherwise identical to the WiFi only version of the tablet (p4wifi). The cellular modem is connected via an internal USB interface called USB HSIC. The mainline Tegra USB driver does not implement this functionality. Much of the work in enabling the cellular stack would involve adding USB HSIC support to the mainline USB driver.


== Other Information ==
==== Hardware Information & Mainline Driver Status ====

The Linux mainlining effort contains drivers forward ported from the stock Samsung Linux 3.1.10 kernel which shipped with the device. Some peripheral devices have been transitioned over to the mainline driver. Other drivers are not in the mainline kernel or the device is not compatible with the mainline driver.

{| class="wikitable feature-colors"
!Peripheral Type
!Hardware
! Mainline Driver<br/>Status
|-
|Analog Digital Converter
|stmpe811
|Y
|-
|Audio
|wm8994
|Y
|-
|Battery
|max17042
|P
|-
|Camera
|s5k5ccgx (front)<br/>s5k6bbgx (back)
| - 
|-
|Charger
|unknown
|P
|-
|CPU Temperature Sensor
|nct1008
|Y
|-
|Display Panel
|cmc623
|P
|-
|GPS
|bcm4751
|P
|-
|GPU
|tegra host1x
|Y 
|-
|HDMI Connector
|sii9234
| -
|-
|Sensors
* gyroscope
* accelerometer
* compass
* light sensor
|<br/>
* mpu3050
* kxtf9
* ak8975
* bh1721fvc
|P
|-
|Touch Digitizer
|mxt1386
|Y

|-
|Vibration Motor
|isa1200
| P 
|-
|Voltage Regulators
|tps6586x
|Y
|-
|Wifi / Bluetooth
|bcm4330
|Y
|-
|3G Modem
|xmm6260
| - 
|-
|3.5mm Jack
|sec_jack
|P
|-
|30-pin accessory port
|unknown 
| - 
|-
|}

===== Mainline Driver Status Legend =====
{| class="wikitable feature-colors"
! Code
! Meaning
|-
  | Y
  | Mainline driver
|-
  | P
  | Forward ported driver
|-
  | -
  | No driver -- driver has not been forward ported
|}

== See also ==
* {{github|1279}} Initial pull request
* [https://github.com/Decatf/linux/ decatf mainline Linux kernel]
* [https://github.com/Decatf/android_kernel_samsung_p4 stock Samsung 3.1.10 kernel]
* [https://github.com/grate-driver/ Grate driver]
* {{github|1386}} Update linux-samsung-p4wifi to kernel 4.16 (with some comments about what's left to do before we could have a shared mainline kernel)
